const t={colorSlice:"#00a1ff",fontColor:"#000",fontSize:"1.6rem",fontWeight:400,lineargradient:!1,number:!0,round:!1,fill:"none",unit:"%",rotation:-90,size:200,stroke:10},e=t=>{let{rotation:e,animationSmooth:o}=t;return`transform:rotate(${e}deg);transform-origin: 50% 50%;${o?`transition: stroke-dashoffset ${o}`:""}`},o=t=>({"stroke-dasharray":t||"264"}),n=t=>{let{round:e}=t;return{"stroke-linecap":e?"round":""}},i=t=>({"font-size":t.fontSize,"font-weight":t.fontWeight}),r=t=>document.querySelector(t),s=(t,e)=>{let{lineargradient:o,index:n,colorSlice:i}=e;t.setAttribute("stroke",o?`url(#linear-${n})`:i)},a=(t,e)=>{for(const o in e)t?.setAttribute(o,e[o])},c=t=>document.createElementNS("http://www.w3.org/2000/svg",t),l=(t,e)=>{const o=c("tspan");return o.classList.add(t),e&&(o.textContent=e),o},d=(t,e,o)=>{const n=264-t/100*(o?2.64*(100-o):264);return e?-n:n},f=function(t,e,o){return void 0===o&&(o="beforeend"),t.insertAdjacentElement(o,e)};class h{constructor(t,e){void 0===e&&(e={}),this.t=t,this.o=e;const o=document.querySelectorAll(`.${t}`),n=[].slice.call(o);n.map(((t,o)=>{const n=JSON.parse(t.getAttribute("data-pie"));t.setAttribute("data-pie-index",n.index||e.index||o+1)})),this.i=n}initial(t){const e=t||this.i;Array.isArray(e)?e.map((t=>this.l(t))):this.l(e)}h(t,d,h){const u=this.t;h.number&&f(t,((t,e)=>{const o=c("text");o.classList.add(`${e}-text-${t.index}`),f(o,l(`${e}-percent-${t.index}`)),f(o,l(`${e}-unit-${t.index}`,t.unit));const n={x:"50%",y:"50%",fill:t.fontColor,"text-anchor":"middle",dy:t.textPosition||"0.35em",...i(t)};return a(o,n),o})(h,u));const $=r(`.${u}-circle-${h.index}`),m={fill:"none","stroke-width":h.stroke,"stroke-dashoffset":"264",...o(),...n(h)};a($,m),this.animationTo({...h,element:$},!0),$.setAttribute("style",e(h)),s($,h),d.setAttribute("style",`width:${h.size}px;height:${h.size}px;`)}animationTo(e,o){void 0===o&&(o=!1);const n=this.t,c=JSON.parse(r(`[data-pie-index="${e.index}"]`).getAttribute("data-pie")),l=r(`.${n}-circle-${e.index}`);if(!l)return;const f=o?e:{...t,...c,...e,...this.o};if(o||s(l,f),!o&&f.number){const t={fill:f.fontColor,...i(f)},e=r(`.${n}-text-${f.index}`);a(e,t)}const h=r(`.${n}-percent-${e.index}`);if(f.animationOff)return f.number&&(h.textContent=`${f.percent}`),void l.setAttribute("stroke-dashoffset",d(f.percent*((100-(f.cut||0))/100),f.inverse));let u=JSON.parse(l.getAttribute("data-angel"));const $=Math.round(e.percent);if(0===$&&(f.number&&(h.textContent="0"),l.setAttribute("stroke-dashoffset","264")),$>100||$<0||u===$)return;let m,p=o?0:u;const g=1e3/(f.speed||1e3);let x=performance.now();const k=t=>{m=requestAnimationFrame(k);const e=t-x;e>=g-.1&&(x=t-e%g,p=p<f.percent?p+1:p-1),l.setAttribute("stroke-dashoffset",d(p,f.inverse,f.cut)),h&&f.number&&(h.textContent=`${p}`),l.setAttribute("data-angel",p),l.parentNode.setAttribute("aria-valuenow",p),p===$&&cancelAnimationFrame(m)};requestAnimationFrame(k)}l(e){const o=e.getAttribute("data-pie-index"),n=JSON.parse(e.getAttribute("data-pie")),i={...t,...n,index:o,...this.o},r=c("svg"),s={role:"progressbar",width:i.size,height:i.size,viewBox:"0 0 100 100","aria-valuemin":"0","aria-valuemax":"100"};a(r,s),i.colorCircle&&r.appendChild(this.u(i)),i.lineargradient&&r.appendChild((t=>{let{index:e,lineargradient:o}=t;const n=c("defs"),i=c("linearGradient");i.id=`linear-${e}`;const r=[].slice.call(o);n.appendChild(i);let s=0;return r.map((t=>{const e=c("stop");a(e,{offset:`${s}%`,"stop-color":`${t}`}),i.appendChild(e),s+=100/(r.length-1)})),n})(i)),r.appendChild(this.u(i,"top")),e.appendChild(r),this.h(r,e,i)}u(t,i){void 0===i&&(i="bottom");const r=c("circle");let s={};if(t.cut){const i=264-2.64*(100-t.cut);s={"stroke-dashoffset":t.inverse?-i:i,style:e(t),...o(),...n(t)}}const l={fill:t.fill,stroke:t.colorCircle,"stroke-width":t.strokeBottom||t.stroke,...s};t.strokeDasharray&&Object.assign(l,{...o(t.strokeDasharray)});const d={cx:"50%",cy:"50%",r:42,"shape-rendering":"geometricPrecision",..."top"===i?{class:`${this.t}-circle-${t.index}`}:l};return a(r,d),r}}export{h as default};
